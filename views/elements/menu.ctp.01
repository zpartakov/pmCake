<!-- dynamic menu/navigation -->
<div id="cakephp-global-navigation">
<ul id="menuDeroulant">
<?php
/*dynamic cake navigation */
#echo "<h1>Menus</h1>"; 
//exit;
#$sqlM="SELECT * FROM pm_menus ORDER BY parent,rank";
$sqlM="SELECT * FROM pm_menus WHERE parent=0 ORDER BY rank";

$sqlM=mysql_query($sqlM);
if(!$sqlM) { echo "SQL error: " .mysql_error(); }

$i=0;
while($i<mysql_num_rows($sqlM)){
	echo "<li style=\"" .mysql_result($sqlM,$i,"style_li") ."\">";
	if(strlen(mysql_result($sqlM,$i,'img'))>0) { //image
				echo $html->image(mysql_result($sqlM,$i,'img'), array('url' => mysql_result($sqlM,$i,"url"), 'alt' => mysql_result($sqlM,$i,"lib"), 'title' => utf8_encode(mysql_result($sqlM,$i,"lib")), 'style'=>mysql_result($sqlM,$i,"style_img")));

	} else { //normal link
	
	echo $html->link(__(utf8_encode(mysql_result($sqlM,$i,'lib')), true), mysql_result($sqlM,$i,"url"));
	}
	
	/*sous-menus begin */
	
	$sqlSsMenus="SELECT * FROM pm_menus WHERE parent =".mysql_result($sqlM,$i,"id") ." ORDER BY rank";
	#echo $sqlSsMenus;
	$sqlSsMenus=mysql_query($sqlSsMenus);
	if(!$sqlSsMenus) { echo "SQL error: " .mysql_error(); }
	if(mysql_num_rows($sqlSsMenus)>0) {
		echo '<ul class="sousMenu">';

	$i2=0;
	while($i2<mysql_num_rows($sqlSsMenus)){
		echo "<li>";
			echo $html->link(__(utf8_encode(mysql_result($sqlSsMenus,$i2,'lib')), true), mysql_result($sqlSsMenus,$i2,"url"));
		echo "</li>";
		if(mysql_result($sqlSsMenus,$i2,'line_after')=="1") { //put a line after that item
		{
			#echo "		<div style=\"height:3px\"><li><hr /></li></div>";
		}
		
		$i2++;
		}
		echo "</ul>\n";
	}
	
	/*sous-menus end */
	
	
	
	
	
	
	echo "</li>\n\n";
	$i++;
	}

?>
</ul>	  
</div>
